# wiki/management/commands/seed_witcher.py
import os
import random
from datetime import datetime, timedelta
from django.core.management.base import BaseCommand
from django.contrib.auth.models import User, Group
from django.utils import timezone
from wiki.models import (
    Category, Article, Comment, ArticleLike, CommentLike,
    UserProfile, SearchQuery, SearchHistory,
    ArticleMedia, ActionLog
)


class Command(BaseCommand):
    help = '–ó–∞–ø–æ–ª–Ω—è–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤—Å–µ–ª–µ–Ω–Ω–æ–π –í–µ–¥—å–º–∞–∫–∞: 25 —Å—Ç–∞—Ç–µ–π, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, –ª–∞–π–∫–∏'

    def handle(self, *args, **kwargs):
        self.stdout.write('üéÆ –ù–∞—á–∏–Ω–∞–µ–º –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤—Å–µ–ª–µ–Ω–Ω–æ–π –í–µ–¥—å–º–∞–∫–∞...')

        # –ü–æ–ª—É—á–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        categories = self.get_categories()

        # –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç)
        users = self.create_users()

        # –°–æ–∑–¥–∞–µ–º —Å—Ç–∞—Ç—å–∏ –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        articles = self.create_articles(categories, users)

        # –°–æ–∑–¥–∞–µ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ —Å—Ç–∞—Ç—å—è–º
        comments = self.create_comments(articles, users)

        # –î–æ–±–∞–≤–ª—è–µ–º –ª–∞–π–∫–∏ –∫ —Å—Ç–∞—Ç—å—è–º
        self.create_article_likes(articles, users)

        # –î–æ–±–∞–≤–ª—è–µ–º –ª–∞–π–∫–∏ –∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º
        self.create_comment_likes(comments, users)

        # –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        self.create_user_profiles(users)

        # –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –ø–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
        self.create_search_data(users, articles)

        self.stdout.write(self.style.SUCCESS('‚úÖ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤—Å–µ–ª–µ–Ω–Ω–æ–π –í–µ–¥—å–º–∞–∫–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω—ã!'))
        self.print_statistics(categories, users, articles, comments)

    def get_categories(self):
        """–ü–æ–ª—É—á–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ –∏–º–µ–Ω–∞–º"""
        category_names = ['–ü–µ—Ä—Å–æ–Ω–∞–∂–∏', '–õ–æ–∫–∞—Ü–∏–∏', '–ú–æ–Ω—Å—Ç—Ä—ã', '–°–æ–±—ã—Ç–∏—è', '–ú–∞–≥–∏—è']
        categories = []

        for name in category_names:
            try:
                category = Category.objects.get(name=name)
                categories.append(category)
                self.stdout.write(f"‚úÖ –ù–∞–π–¥–µ–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è: {name}")
            except Category.DoesNotExist:
                self.stdout.write(self.style.WARNING(f"‚ö†Ô∏è –ö–∞—Ç–µ–≥–æ—Ä–∏—è '{name}' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –ü—Ä–æ–ø—É—Å–∫–∞–µ–º..."))

        if not categories:
            self.stdout.write(self.style.ERROR("‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω–æ –Ω–∏ –æ–¥–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏!"))
            raise Exception("–°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É")

        return categories

    def create_users(self):
        """–°–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
        users_data = [
            {'username': 'geralt_rivia', 'email': 'geralt@witcher.com'},
            {'username': 'yennefer_vengerberg', 'email': 'yennefer@witcher.com'},
            {'username': 'ciri_fiona', 'email': 'ciri@witcher.com'},
            {'username': 'triss_merigold', 'email': 'triss@witcher.com'},
            {'username': 'vesemir', 'email': 'vesemir@kaermorhen.com'},
            {'username': 'dandelion', 'email': 'dandelion@oxenfurt.com'},
            {'username': 'zoltan_chivay', 'email': 'zoltan@dwarf.com'},
            {'username': 'keira_metz', 'email': 'keira@magicians.com'},
            {'username': 'regis', 'email': 'regis@highervampire.com'},
            {'username': 'vilgefortz', 'email': 'vilgefortz@nilfgaard.com'},
        ]

        users = []
        for user_data in users_data:
            user, created = User.objects.get_or_create(
                username=user_data['username'],
                defaults={
                    'email': user_data['email'],
                    'is_active': True,
                }
            )
            if created:
                user.set_password('testpass123')
                user.save()
                self.stdout.write(f"‚úÖ –°–æ–∑–¥–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {user.username}")
            else:
                self.stdout.write(f"üìå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: {user.username}")
            users.append(user)

        return users

    def create_articles(self, categories, users):
        """–°–æ–∑–¥–∞–µ—Ç 25 —Å—Ç–∞—Ç–µ–π –≤—Å–µ–ª–µ–Ω–Ω–æ–π –í–µ–¥—å–º–∞–∫–∞ (–ø–æ 5 –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)"""
        articles_data = {
            '–ü–µ—Ä—Å–æ–Ω–∞–∂–∏': [
                {
                    'title': '–ì–µ—Ä–∞–ª—å—Ç –∏–∑ –†–∏–≤–∏–∏ - –ë–µ–ª—ã–π –í–æ–ª–∫',
                    'content': self.generate_witcher_content('–ì–µ—Ä–∞–ª—å—Ç'),
                    'excerpt': '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –≤–µ–¥—å–º–∞–∫, –∏–∑–≤–µ—Å—Ç–Ω—ã–π –∫–∞–∫ –ë–µ–ª—ã–π –í–æ–ª–∫. –ú—É—Ç–∞–Ω—Ç, –ø—Ä–æ—à–µ–¥—à–∏–π –∏—Å–ø—ã—Ç–∞–Ω–∏–µ —Ç—Ä–∞–≤–∞–º–∏.',
                    'tags': '–≤–µ–¥—å–º–∞–∫, –º—É—Ç–∞–Ω—Ç, —à–∫–æ–ª–∞ –≤–æ–ª–∫–∞, –≥–µ—Ä–∞–ª—å—Ç'
                },
                {
                    'title': '–ô–µ–Ω–Ω–∏—Ñ—ç—Ä –∏–∑ –í–µ–Ω–≥–µ—Ä–±–µ—Ä–≥–∞',
                    'content': self.generate_witcher_content('–ô–µ–Ω–Ω–∏—Ñ—ç—Ä'),
                    'excerpt': '–ú–æ–≥—É—â–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —á–∞—Ä–æ–¥–µ–π–∫–∞, —á–ª–µ–Ω –°–æ–≤–µ—Ç–∞ —á–∞—Ä–æ–¥–µ–µ–≤, –≤–æ–∑–ª—é–±–ª–µ–Ω–Ω–∞—è –ì–µ—Ä–∞–ª—å—Ç–∞.',
                    'tags': '—á–∞—Ä–æ–¥–µ–π–∫–∞, –º–∞–≥–∏—è, —Å–æ–≤–µ—Ç —á–∞—Ä–æ–¥–µ–µ–≤, –π–µ–Ω–Ω–∏—Ñ—ç—Ä'
                },
                {
                    'title': '–¶–∏—Ä–∏–ª–ª–∞ –§–∏–æ–Ω–∞ –≠–ª–µ–Ω –†–∏–∞–Ω–Ω–æ–Ω',
                    'content': self.generate_witcher_content('–¶–∏—Ä–∏'),
                    'excerpt': '–ü—Ä–∏–Ω—Ü–µ—Å—Å–∞ –¶–∏–Ω—Ç—Ä—ã, –î–∏—Ç—è –°—Ç–∞—Ä—à–µ–π –ö—Ä–æ–≤–∏, —É—á–µ–Ω–∏—Ü–∞ –≤–µ–¥—å–º–∞–∫–∞ –∏ —á–∞—Ä–æ–¥–µ–π–∫–∏.',
                    'tags': '–¥–∏—Ç—è-–Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ—Å—Ç—å, —Å—Ç–∞—Ä–∞—è –∫—Ä–æ–≤—å, —Ü–∏—Ä–∏, –ø—Ä–∏–Ω—Ü–µ—Å—Å–∞'
                },
                {
                    'title': '–¢—Ä–∏—Å—Å –ú–µ—Ä–∏–≥–æ–ª—å–¥',
                    'content': self.generate_witcher_content('–¢—Ä–∏—Å—Å'),
                    'excerpt': '–ß–∞—Ä–æ–¥–µ–π–∫–∞, –ø–æ–¥—Ä—É–≥–∞ –ì–µ—Ä–∞–ª—å—Ç–∞, –∏–∑–≤–µ—Å—Ç–Ω–∞—è —Å–≤–æ–∏–º–∏ —Ä—ã–∂–∏–º–∏ –≤–æ–ª–æ—Å–∞–º–∏ –∏ –¥–æ–±—Ä—ã–º —Å–µ—Ä–¥—Ü–µ–º.',
                    'tags': '—á–∞—Ä–æ–¥–µ–π–∫–∞, —Ä—ã–∂–∞—è, –º–µ—Ä–≤–µ–π–ª–ª–∏–Ω–≥, —Ç—Ä–∏—Å—Å'
                },
                {
                    'title': '–í–µ—Å–∏–º–∏—Ä - —Å—Ç–∞—Ä–µ–π—à–∏–π –≤–µ–¥—å–º–∞–∫',
                    'content': self.generate_witcher_content('–í–µ—Å–∏–º–∏—Ä'),
                    'excerpt': '–°—Ç–∞—Ä–µ–π—à–∏–π –∏ —Å–∞–º—ã–π –æ–ø—ã—Ç–Ω—ã–π –≤–µ–¥—å–º–∞–∫ –®–∫–æ–ª—ã –í–æ–ª–∫–∞, –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫ –ì–µ—Ä–∞–ª—å—Ç–∞.',
                    'tags': '–≤–µ–¥—å–º–∞–∫, –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫, –∫–∞—ç—Ä –º–æ—Ä—Ö–µ–Ω, –≤–µ—Å–∏–º–∏—Ä'
                },
            ],
            '–õ–æ–∫–∞—Ü–∏–∏': [
                {
                    'title': '–ö–∞—ç—Ä –ú–æ—Ä—Ö–µ–Ω - –∫—Ä–µ–ø–æ—Å—Ç—å –≤–µ–¥—å–º–∞–∫–æ–≤',
                    'content': self.generate_witcher_content('–ö–∞—ç—Ä –ú–æ—Ä—Ö–µ–Ω'),
                    'excerpt': '–î—Ä–µ–≤–Ω—è—è –∫—Ä–µ–ø–æ—Å—Ç—å –≤–µ–¥—å–º–∞–∫–æ–≤ –®–∫–æ–ª—ã –í–æ–ª–∫–∞, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω–∞—è –≤ –≥–æ—Ä–∞—Ö.',
                    'tags': '–∫—Ä–µ–ø–æ—Å—Ç—å, —à–∫–æ–ª–∞ –≤–æ–ª–∫–∞, —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –ª–∞–≥–µ—Ä—å, –∫–∞—ç—Ä –º–æ—Ä—Ö–µ–Ω'
                },
                {
                    'title': '–í—ã–∑–∏–º–∞ - —Å—Ç–æ–ª–∏—Ü–∞ –¢–µ–º–µ—Ä–∏–∏',
                    'content': self.generate_witcher_content('–í—ã–∑–∏–º–∞'),
                    'excerpt': '–°—Ç–æ–ª–∏—Ü–∞ –∫–æ—Ä–æ–ª–µ–≤—Å—Ç–≤–∞ –¢–µ–º–µ—Ä–∏—è, –∫—Ä—É–ø–Ω—ã–π —Ç–æ—Ä–≥–æ–≤—ã–π –∏ –ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä.',
                    'tags': '—Å—Ç–æ–ª–∏—Ü–∞, —Ç–µ–º–µ—Ä–∏—è, –≥–æ—Ä–æ–¥, –≤—ã–∑–∏–º–∞'
                },
                {
                    'title': '–ù–æ–≤–∏–≥—Ä–∞–¥ - –≥–æ—Ä–æ–¥ –º–æ—Å—Ç–æ–≤',
                    'content': self.generate_witcher_content('–ù–æ–≤–∏–≥—Ä–∞–¥'),
                    'excerpt': '–°–∞–º—ã–π –±–æ–ª—å—à–æ–π –≥–æ—Ä–æ–¥ –°–µ–≤–µ—Ä–∞, –∏–∑–≤–µ—Å—Ç–Ω—ã–π —Å–≤–æ–µ–π –ø—Ä–µ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é –∏ –∏–Ω—Ç—Ä–∏–≥–∞–º–∏.',
                    'tags': '–≥–æ—Ä–æ–¥, –Ω–æ–≤–∏–≥—Ä–∞–¥, –∫—Ä–∏–º–∏–Ω–∞–ª, —Å—Ç–æ–ª–∏—Ü–∞'
                },
                {
                    'title': '–û–∫—Å–µ–Ω—Ñ—É—Ä—Ç—Å–∫–∞—è –∞–∫–∞–¥–µ–º–∏—è',
                    'content': self.generate_witcher_content('–û–∫—Å–µ–Ω—Ñ—É—Ä—Ç'),
                    'excerpt': '–ö—Ä—É–ø–Ω–µ–π—à–∏–π —É—á–µ–±–Ω—ã–π —Ü–µ–Ω—Ç—Ä –Ω–∞ –°–µ–≤–µ—Ä–µ, –∏–∑–≤–µ—Å—Ç–Ω—ã–π —Å–≤–æ–µ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π –∏ —É—á–µ–Ω—ã–º–∏.',
                    'tags': '–∞–∫–∞–¥–µ–º–∏—è, —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç, –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ, –æ–∫—Å–µ–Ω—Ñ—É—Ä—Ç'
                },
                {
                    'title': '–°–∫–µ–ª–ª–∏–≥–µ - –æ—Å—Ç—Ä–æ–≤–∞ –≤–∏–∫–∏–Ω–≥–æ–≤',
                    'content': self.generate_witcher_content('–°–∫–µ–ª–ª–∏–≥–µ'),
                    'excerpt': '–ê—Ä—Ö–∏–ø–µ–ª–∞–≥ —Å—É—Ä–æ–≤—ã—Ö –æ—Å—Ç—Ä–æ–≤–æ–≤, –Ω–∞—Å–µ–ª–µ–Ω–Ω—ã–π –≥–æ—Ä–¥—ã–º–∏ –∫–ª–∞–Ω–∞–º–∏ –≤–æ–∏–Ω–æ–≤.',
                    'tags': '–æ—Å—Ç—Ä–æ–≤–∞, –∫–ª–∞–Ω—ã, –≤–∏–∫–∏–Ω–≥–∏, —Å–∫–µ–ª–ª–∏–≥–µ'
                },
            ],
            '–ú–æ–Ω—Å—Ç—Ä—ã': [
                {
                    'title': '–°—Ç—Ä—ã–≥–∞ - –ø—Ä–æ–∫–ª—è—Ç–∞—è –ø—Ä–∏–Ω—Ü–µ—Å—Å–∞',
                    'content': self.generate_witcher_content('–°—Ç—Ä—ã–≥–∞'),
                    'excerpt': '–ß—É–¥–æ–≤–∏—â–µ, —Ä–æ–∂–¥–µ–Ω–Ω–æ–µ –æ—Ç –ø—Ä–æ–∫–ª—è—Ç–∏—è, –±—ã–≤—à–∞—è –ø—Ä–∏–Ω—Ü–µ—Å—Å–∞ –§–æ–ª—å—Ç–µ—Å—Ç.',
                    'tags': '—á—É–¥–æ–≤–∏—â–µ, –ø—Ä–æ–∫–ª—è—Ç–∏–µ, —Å—Ç—Ä—ã–≥–∞, –∫–æ–Ω—Ç—Ä–∞–∫—Ç'
                },
                {
                    'title': '–õ–µ—à–∏–π - –ª–µ—Å–Ω–æ–π –¥—É—Ö',
                    'content': self.generate_witcher_content('–õ–µ—à–∏–π'),
                    'excerpt': '–î—Ä–µ–≤–Ω–µ–µ –ª–µ—Å–Ω–æ–µ —Å—É—â–µ—Å—Ç–≤–æ, –∑–∞—â–∏—Ç–Ω–∏–∫ –ø—Ä–∏—Ä–æ–¥—ã –∏ –≤—Ä–∞–≥ –ª–µ—Å–æ—Ä—É–±–æ–≤.',
                    'tags': '–ª–µ—Å–Ω–æ–π –¥—É—Ö, –ø—Ä–∏—Ä–æ–¥–∞, –∑–∞—â–∏—Ç–Ω–∏–∫, –ª–µ—à–∏–π'
                },
                {
                    'title': '–í–æ–¥—è–Ω–æ–π - –ø–æ–≤–µ–ª–∏—Ç–µ–ª—å –±–æ–ª–æ—Ç',
                    'content': self.generate_witcher_content('–í–æ–¥—è–Ω–æ–π'),
                    'excerpt': '–ë–æ–ª–æ—Ç–Ω–æ–µ —á—É–¥–æ–≤–∏—â–µ, –Ω–∞–ø–∞–¥–∞—é—â–µ–µ –Ω–∞ –ø—É—Ç–Ω–∏–∫–æ–≤ –∏ —Ä—ã–±–∞–∫–æ–≤.',
                    'tags': '–≤–æ–¥—è–Ω–æ–π, –±–æ–ª–æ—Ç–æ, —É—Ç–æ–ø–ª–µ–Ω–Ω–∏–∫, —á—É–¥–æ–≤–∏—â–µ'
                },
                {
                    'title': '–ë—Ä—É–∫—Å–∞ - –ø–æ–ª—É–¥–µ–Ω–Ω–∏—Ü–∞',
                    'content': self.generate_witcher_content('–ë—Ä—É–∫—Å–∞'),
                    'excerpt': '–ñ–µ–Ω—Å–∫–∏–π –ø—Ä–∏–∑—Ä–∞–∫, –ø–æ—è–≤–ª—è—é—â–∏–π—Å—è –≤ –ø–æ–ª–¥–µ–Ω—å –∏ –Ω–∞–ø–∞–¥–∞—é—â–∏–π –Ω–∞ –æ–¥–∏–Ω–æ–∫–∏—Ö –ø—É—Ç–Ω–∏–∫–æ–≤.',
                    'tags': '–ø—Ä–∏–∑—Ä–∞–∫, –ø–æ–ª—É–¥–µ–Ω–Ω–∏—Ü–∞, –±—Ä—É–∫—Å–∞, –ø—Ä–æ–∫–ª—è—Ç–∏–µ'
                },
                {
                    'title': '–î–æ–ø–ø–ª–µ—Ä - —Å—É—â–µ—Å—Ç–≤–æ-–∏–º–∏—Ç–∞—Ç–æ—Ä',
                    'content': self.generate_witcher_content('–î–æ–ø–ø–ª–µ—Ä'),
                    'excerpt': '–°—É—â–µ—Å—Ç–≤–æ, —Å–ø–æ—Å–æ–±–Ω–æ–µ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –æ–±–ª–∏–∫ –ª—é–±–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ –∏–ª–∏ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ.',
                    'tags': '–¥–æ–ø–ø–ª–µ—Ä, –∏–º–∏—Ç–∞—Ç–æ—Ä, –ø—Ä–µ–≤—Ä–∞—â–µ–Ω–∏–µ, —Ä–∞–∑—É–º–Ω–æ–µ'
                },
            ],
            '–°–æ–±—ã—Ç–∏—è': [
                {
                    'title': '–ë–∏—Ç–≤–∞ –ø—Ä–∏ –ë—Ä–µ–Ω–Ω–µ',
                    'content': self.generate_witcher_content('–ë–∏—Ç–≤–∞ –ø—Ä–∏ –ë—Ä–µ–Ω–Ω–µ'),
                    'excerpt': '–†–µ—à–∞—é—â–∞—è –±–∏—Ç–≤–∞ –í—Ç–æ—Ä–æ–π –°–µ–≤–µ—Ä–Ω–æ–π –≤–æ–π–Ω—ã –º–µ–∂–¥—É –ù–∏–ª—å—Ñ–≥–∞–∞—Ä–¥–æ–º –∏ –°–µ–≤–µ—Ä–Ω—ã–º–∏ –∫–æ—Ä–æ–ª–µ–≤—Å—Ç–≤–∞–º–∏.',
                    'tags': '–±–∏—Ç–≤–∞, –≤–æ–π–Ω–∞, –Ω–∏–ª—å—Ñ–≥–∞–∞—Ä–¥, —Å–µ–≤–µ—Ä'
                },
                {
                    'title': '–†–µ–∑–Ω—è –≤ –¶–∏–Ω—Ç—Ä–µ',
                    'content': self.generate_witcher_content('–†–µ–∑–Ω—è –≤ –¶–∏–Ω—Ç—Ä–µ'),
                    'excerpt': '–ó–∞—Ö–≤–∞—Ç –¶–∏–Ω—Ç—Ä—ã –ù–∏–ª—å—Ñ–≥–∞–∞—Ä–¥–æ–º –∏ –≥–∏–±–µ–ª—å –∫–æ—Ä–æ–ª–µ–≤—ã –ö–∞–ª–∞–Ω—Ç—ç.',
                    'tags': '—Ü–∏–Ω—Ç—Ä–∞, —Ä–µ–∑–Ω—è, –Ω–∏–ª—å—Ñ–≥–∞–∞—Ä–¥, –ø–∞–¥–µ–Ω–∏–µ'
                },
                {
                    'title': '–°–∞–±–∞–Ω—Å–∫–∞—è –Ω–æ—á—å',
                    'content': self.generate_witcher_content('–°–∞–±–∞–Ω—Å–∫–∞—è –Ω–æ—á—å'),
                    'excerpt': '–í–æ—Å—Å—Ç–∞–Ω–∏–µ –Ω–µ–ª—é–¥–µ–π –≤ –í—ã–∑–∏–º–µ –ø—Ä–æ—Ç–∏–≤ –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏–∏ –∏ –Ω–∞—Å–∏–ª–∏—è.',
                    'tags': '–≤–æ—Å—Å—Ç–∞–Ω–∏–µ, –Ω–µ–ª—é–¥–∏, —Å–∞–±–∞–Ω, –Ω–æ—á—å'
                },
                {
                    'title': '–°—É–¥ –Ω–∞–¥ –≤–µ–¥—å–º–∞–∫–∞–º–∏',
                    'content': self.generate_witcher_content('–°—É–¥ –Ω–∞–¥ –≤–µ–¥—å–º–∞–∫–∞–º–∏'),
                    'excerpt': '–°—É–¥–µ–±–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞–¥ –≤–µ–¥—å–º–∞–∫–∞–º–∏ –≤ –í—ã–∑–∏–º–µ, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–ª–∏–≥–∏–æ–∑–Ω—ã–º–∏ —Ñ–∞–Ω–∞—Ç–∏–∫–∞–º–∏.',
                    'tags': '—Å—É–¥, –≤–µ–¥—å–º–∞–∫–∏, –ø—Ä–µ—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ, —Ä–µ–ª–∏–≥–∏—è'
                },
                {
                    'title': '–ö–æ–Ω—ä—é–Ω–∫—Ü–∏—è —Å—Ñ–µ—Ä',
                    'content': self.generate_witcher_content('–ö–æ–Ω—ä—é–Ω–∫—Ü–∏—è —Å—Ñ–µ—Ä'),
                    'excerpt': '–ö–æ—Å–º–∏—á–µ—Å–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ, —Å–æ–µ–¥–∏–Ω–∏–≤—à–µ–µ —Ä–∞–∑–Ω—ã–µ –º–∏—Ä—ã –∏ –ø—Ä–∏–Ω–µ—Å—à–µ–µ –º–æ–Ω—Å—Ç—Ä–æ–≤.',
                    'tags': '–∫–æ–Ω—ä—é–Ω–∫—Ü–∏—è, –º–∏—Ä—ã, –º–æ–Ω—Å—Ç—Ä—ã, –º–∞–≥–∏—è'
                },
            ],
            '–ú–∞–≥–∏—è': [
                {
                    'title': '–ó–Ω–∞–∫–∏ –≤–µ–¥—å–º–∞–∫–∞',
                    'content': self.generate_witcher_content('–ó–Ω–∞–∫–∏ –≤–µ–¥—å–º–∞–∫–∞'),
                    'excerpt': '–ü—Ä–æ—Å—Ç—ã–µ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤–µ–¥—å–º–∞–∫–∞–º —á–µ—Ä–µ–∑ –∂–µ—Å—Ç—ã —Ä—É–∫.',
                    'tags': '–∑–Ω–∞–∫–∏, –º–∞–≥–∏—è, –≤–µ–¥—å–º–∞–∫–∏, –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è'
                },
                {
                    'title': '–≠–ª–∏–∫—Å–∏—Ä—ã –∏ –∑–µ–ª—å—è',
                    'content': self.generate_witcher_content('–≠–ª–∏–∫—Å–∏—Ä—ã –≤–µ–¥—å–º–∞–∫–∞'),
                    'excerpt': '–ê–ª—Ö–∏–º–∏—á–µ—Å–∫–∏–µ —Å–æ—Å—Ç–∞–≤—ã, —É—Å–∏–ª–∏–≤–∞—é—â–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –≤–µ–¥—å–º–∞–∫–æ–≤ –∏ –∑–∞—â–∏—â–∞—é—â–∏–µ –æ—Ç —è–¥–æ–≤.',
                    'tags': '—ç–ª–∏–∫—Å–∏—Ä—ã, –∑–µ–ª—å—è, –∞–ª—Ö–∏–º–∏—è, —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å'
                },
                {
                    'title': '–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –º–∞–≥–∏–∏',
                    'content': self.generate_witcher_content('–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –º–∞–≥–∏–∏'),
                    'excerpt': '–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–∫–æ–ø–ª–µ–Ω–∏—è –º–∞–≥–∏—á–µ—Å–∫–æ–π —ç–Ω–µ—Ä–≥–∏–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —á–∞—Ä–æ–¥–µ—è–º–∏.',
                    'tags': '–º–∞–≥–∏—è, –∏—Å—Ç–æ—á–Ω–∏–∫–∏, —ç–Ω–µ—Ä–≥–∏—è, —Ö–∞–æ—Å'
                },
                {
                    'title': '–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –î—Ä–µ–≤–Ω–µ–π –†–∞—Å—ã',
                    'content': self.generate_witcher_content('–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã'),
                    'excerpt': '–î—Ä–µ–≤–Ω–∏–µ –º–∞–≥–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥–º–µ—Ç—ã, –æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ —ç–ª—å—Ñ–∞–º–∏ –∏ –≥–Ω–æ–º–∞–º–∏.',
                    'tags': '–∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã, –¥—Ä–µ–≤–Ω—è—è —Ä–∞—Å–∞, –º–∞–≥–∏—è, —Ä–µ–ª–∏–∫–≤–∏–∏'
                },
                {
                    'title': '–û–¥–µ—Ä–∂–∏–º–æ—Å—Ç—å –∏ –ø—Ä–æ–∫–ª—è—Ç–∏—è',
                    'content': self.generate_witcher_content('–ü—Ä–æ–∫–ª—è—Ç–∏—è'),
                    'excerpt': '–ú–∞–≥–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–∫–ª—è—Ç–∏—è, –ø—Ä–µ–≤—Ä–∞—â–∞—é—â–∏–µ –ª—é–¥–µ–π –≤ —á—É–¥–æ–≤–∏—â –∏ –ø—Ä–∏–∑—Ä–∞–∫–æ–≤.',
                    'tags': '–ø—Ä–æ–∫–ª—è—Ç–∏—è, –æ–¥–µ—Ä–∂–∏–º–æ—Å—Ç—å, –ø—Ä–∏–∑—Ä–∞–∫–∏, —Å–Ω—è—Ç–∏–µ'
                },
            ],
        }

        articles = []
        for category in categories:
            category_articles_data = articles_data.get(category.name, [])

            for article_data in category_articles_data:
                # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∞–≤—Ç–æ—Ä–∞
                author = random.choice(users)

                # –°–ª—É—á–∞–π–Ω—ã–π —Å—Ç–∞—Ç—É—Å (–±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ)
                status_weights = ['published'] * 15 + ['draft'] * 5 + ['review'] * 5
                status = random.choice(status_weights)

                # –°–æ–∑–¥–∞–µ–º slug
                slug = self.slugify(article_data['title'])
                # –î–µ–ª–∞–µ–º slug —É–Ω–∏–∫–∞–ª—å–Ω—ã–º
                counter = 1
                original_slug = slug
                while Article.objects.filter(slug=slug).exists():
                    slug = f"{original_slug}-{counter}"
                    counter += 1

                article = Article.objects.create(
                    title=article_data['title'],
                    slug=slug,
                    content=article_data['content'],
                    excerpt=article_data['excerpt'],
                    author=author,
                    status=status,
                    views_count=random.randint(50, 1000),
                )

                # –ï—Å–ª–∏ —Å—Ç–∞—Ç—å—è –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–∞—Ç—É –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
                if status == 'published':
                    article.published_at = timezone.now() - timedelta(days=random.randint(1, 365))
                    article.save()

                # –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                article.categories.add(category)

                # –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–≥–∏
                if article_data.get('tags'):
                    for tag in article_data['tags'].split(', '):
                        article.tags.add(tag.strip())

                articles.append(article)
                self.stdout.write(f"üìù –°–æ–∑–¥–∞–Ω–∞ —Å—Ç–∞—Ç—å—è: '{article.title}' –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ '{category.name}'")

        return articles

    def create_comments(self, articles, users):
        """–°–æ–∑–¥–∞–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ —Å—Ç–∞—Ç—å—è–º"""
        comments = []
        comment_templates = [
            "–û—Ç–ª–∏—á–Ω–∞—è —Å—Ç–∞—Ç—å—è! –û—á–µ–Ω—å –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ.",
            "–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ, –º–Ω–æ–≥–æ –Ω–æ–≤–æ–≥–æ —É–∑–Ω–∞–ª.",
            "–ï—Å—Ç—å –Ω–µ–±–æ–ª—å—à–∞—è –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç—å –≤ –¥–∞—Ç–∞—Ö, –Ω–æ –≤ —Ü–µ–ª–æ–º —Ö–æ—Ä–æ—à–æ.",
            "–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª, –∂–¥—É –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è!",
            "–ú–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –¥–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –¥–µ—Ç–∞–ª–µ–π –æ {topic}.",
            "–ö–∞–∫ –≤—Å–µ–≥–¥–∞ –Ω–∞ –≤—ã—Å–æ—Ç–µ!",
            "–ü—Ä–æ—á–∏—Ç–∞–ª —Å –±–æ–ª—å—à–∏–º –∏–Ω—Ç–µ—Ä–µ—Å–æ–º.",
            "–ï—Å—Ç—å —á—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å –∏–∑ —Å–≤–æ–µ–≥–æ –æ–ø—ã—Ç–∞...",
            "–°–ø–∞—Å–∏–±–æ –∞–≤—Ç–æ—Ä—É –∑–∞ –ø—Ä–æ–¥–µ–ª–∞–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É!",
            "–û—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤.",
        ]

        for article in articles:
            # –°–æ–∑–¥–∞–µ–º 3-10 –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∫ –∫–∞–∂–¥–æ–π —Å—Ç–∞—Ç—å–µ
            num_comments = random.randint(3, 10)
            for i in range(num_comments):
                author = random.choice(users)
                template = random.choice(comment_templates)

                # –ó–∞–º–µ–Ω—è–µ–º placeholder –µ—Å–ª–∏ –µ—Å—Ç—å
                if '{topic}' in template:
                    topics = ['–±–∏—Ç–≤–µ', '–ø–µ—Ä—Å–æ–Ω–∞–∂–µ', '–ª–æ–∫–∞—Ü–∏–∏', '–º–∞–≥–∏–∏', '–º–æ–Ω—Å—Ç—Ä–µ']
                    template = template.format(topic=random.choice(topics))

                comment = Comment.objects.create(
                    article=article,
                    author=author,
                    content=template,
                    like_count=0,
                    is_approved=True
                )
                comments.append(comment)

                # 30% —à–∞–Ω—Å —Å–æ–∑–¥–∞—Ç—å –æ—Ç–≤–µ—Ç –Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
                if random.random() < 0.3 and comments:
                    parent_comment = random.choice(comments[-5:]) if len(comments) > 5 else random.choice(comments)
                    reply_author = random.choice([u for u in users if u != author])

                    reply_templates = [
                        "–°–æ–≥–ª–∞—Å–µ–Ω —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –∫–æ–º–º–µ–Ω—Ç–∞—Ç–æ—Ä–æ–º!",
                        "–•–æ—Ä–æ—à–µ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é.",
                        "–ê –≤–æ—Ç —è –¥—É–º–∞—é –∏–Ω–∞—á–µ...",
                        "–î–æ–ø–æ–ª–Ω—é —Å–∫–∞–∑–∞–Ω–Ω–æ–µ...",
                        "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è —Ç–æ—á–∫–∞ –∑—Ä–µ–Ω–∏—è!"
                    ]

                    Comment.objects.create(
                        article=article,
                        author=reply_author,
                        parent=parent_comment,
                        content=random.choice(reply_templates),
                        like_count=0,
                        is_approved=True
                    )

        self.stdout.write(f"üí¨ –°–æ–∑–¥–∞–Ω–æ {len(comments)} –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤")
        return comments

    def create_article_likes(self, articles, users):
        """–î–æ–±–∞–≤–ª—è–µ—Ç –ª–∞–π–∫–∏ –∫ —Å—Ç–∞—Ç—å—è–º"""
        total_likes = 0
        for article in articles:
            # –ö–∞–∂–¥–∞—è —Å—Ç–∞—Ç—å—è –ø–æ–ª—É—á–∞–µ—Ç –ª–∞–π–∫–∏ –æ—Ç 30-80% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            num_likers = random.randint(int(len(users) * 0.3), int(len(users) * 0.8))
            likers = random.sample(users, min(num_likers, len(users)))

            for user in likers:
                like, created = ArticleLike.objects.get_or_create(
                    user=user,
                    article=article
                )
                if created:
                    total_likes += 1

        self.stdout.write(f"‚ù§Ô∏è –î–æ–±–∞–≤–ª–µ–Ω–æ {total_likes} –ª–∞–π–∫–æ–≤ –∫ —Å—Ç–∞—Ç—å—è–º")

    def create_comment_likes(self, comments, users):
        """–î–æ–±–∞–≤–ª—è–µ—Ç –ª–∞–π–∫–∏ –∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º"""
        total_likes = 0
        for comment in comments:
            # –ö–∞–∂–¥—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ø–æ–ª—É—á–∞–µ—Ç –ª–∞–π–∫–∏ –æ—Ç 0-5 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            num_likers = random.randint(0, min(5, len(users)))
            if num_likers > 0:
                likers = random.sample(users, num_likers)

                for user in likers:
                    like, created = CommentLike.objects.get_or_create(
                        user=user,
                        comment=comment
                    )
                    if created:
                        comment.like_count += 1
                        total_likes += 1

        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å—á–µ—Ç—á–∏–∫–∏
        for comment in comments:
            if comment.like_count > 0:
                comment.save()

        self.stdout.write(f"üëç –î–æ–±–∞–≤–ª–µ–Ω–æ {total_likes} –ª–∞–π–∫–æ–≤ –∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º")

    def create_user_profiles(self, users):
        """–°–æ–∑–¥–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
        for user in users:
            profile, created = UserProfile.objects.get_or_create(
                user=user,
                defaults={
                    'bio': self.generate_user_bio(user.username),
                }
            )

            # –î–æ–±–∞–≤–ª—è–µ–º —Å–æ—Ü—Å–µ—Ç–∏ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            if random.random() < 0.7:
                if 'geralt' in user.username.lower():
                    profile.telegram = 'https://t.me/white_wolf'
                    profile.discord = 'GeraltRivia#1234'
                elif 'yennefer' in user.username.lower():
                    profile.telegram = 'https://t.me/yennefer_v'
                    profile.vk = 'https://vk.com/yennefer_mage'
                elif 'dandelion' in user.username.lower():
                    profile.youtube = 'https://youtube.com/dandelion_bard'
                    profile.vk = 'https://vk.com/dandelion_poet'

            profile.save()

    def create_search_data(self, users, articles):
        """–°–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ –ø–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã"""
        search_queries = [
            '–≤–µ–¥—å–º–∞–∫', '–≥–µ—Ä–∞–ª—å—Ç', '–º–∞–≥–∏—è', '–º–æ–Ω—Å—Ç—Ä—ã', '–Ω–∏–ª—å—Ñ–≥–∞–∞—Ä–¥',
            '—Ü–∏–Ω—Ç—Ä–∞', '—á–∞—Ä–æ–¥–µ–π–∫–∏', '—ç–ª–∏–∫—Å–∏—Ä—ã', '–±–∏—Ç–≤–∞ –ø—Ä–∏ –±—Ä–µ–Ω–Ω–µ',
            '—à–∫–æ–ª–∞ –≤–æ–ª–∫–∞', '–∫–∞—ç—Ä –º–æ—Ä—Ö–µ–Ω', '—Ü–∏—Ä–∏', '–π–µ–Ω–Ω–∏—Ñ—ç—Ä', '—Ç—Ä–∏—Å—Å',
            '—Å–æ–±—ã—Ç–∏—è –≤–µ–¥—å–º–∞–∫–∞', '–ª–æ–∫–∞—Ü–∏–∏ –∏–≥—Ä—ã', '–∫–≤–µ—Å—Ç—ã', '–∞–ª—Ö–∏–º–∏—è',
            '–∑–Ω–∞–∫–∏ –≤–µ–¥—å–º–∞–∫–∞', '–¥–æ–ø–ø–ª–µ—Ä', '–ª–µ—à–∏–π', '–≤–æ–¥—è–Ω–æ–π'
        ]

        for query in search_queries:
            try:
                # –ò—Å–ø–æ–ª—å–∑—É–µ–º filter().first() –≤–º–µ—Å—Ç–æ get_or_create
                search_query = SearchQuery.objects.filter(query=query).first()

                if search_query:
                    # –ï—Å–ª–∏ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫
                    search_query.count += random.randint(1, 10)
                    search_query.save()
                    self.stdout.write(f"üìä –û–±–Ω–æ–≤–ª–µ–Ω –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å: '{query}'")
                else:
                    # –ï—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π
                    search_query = SearchQuery.objects.create(
                        query=query,
                        count=random.randint(1, 50)
                    )
                    self.stdout.write(f"üîç –°–æ–∑–¥–∞–Ω –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å: '{query}'")

                # –°–æ–∑–¥–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –ø–æ–∏—Å–∫–∞
                for _ in range(random.randint(1, 5)):
                    user = random.choice(users) if random.random() < 0.7 else None
                    SearchHistory.objects.create(
                        query=query,
                        user=user,
                        results_count=random.randint(1, 50)
                    )

            except Exception as e:
                self.stdout.write(self.style.WARNING(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–∏—Å–∫–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ '{query}': {e}"))
                continue

    def generate_witcher_content(self, topic):
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç —Å—Ç–∞—Ç—å–∏ –Ω–∞ —Ç–µ–º—É –í–µ–¥—å–º–∞–∫–∞"""
        templates = [
            f"""
            <h2>–ò—Å—Ç–æ—Ä–∏—è –∏ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ</h2>
            <p>{topic} —è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–æ–π –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö —Ñ–∏–≥—É—Ä –≤ –≤—Å–µ–ª–µ–Ω–Ω–æ–π –í–µ–¥—å–º–∞–∫–∞. –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏—è —É—Ö–æ–¥–∏—Ç –∫–æ—Ä–Ω—è–º–∏ –≤ –¥—Ä–µ–≤–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∞, –∫–æ–≥–¥–∞ —Ç–æ–ª—å–∫–æ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–ª–∏—Å—å –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –º–∏—Ä–∞.</p>

            <h2>–û—Å–Ω–æ–≤–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</h2>
            <p>–°—Ä–µ–¥–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π –º–æ–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–ª–∞—é—Ç {topic} –Ω–µ–ø–æ–≤—Ç–æ—Ä–∏–º—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º –≤—Å–µ–ª–µ–Ω–Ω–æ–π. –ú–Ω–æ–≥–∏–µ –∏–≥—Ä–æ–∫–∏ –∏ —á–∏—Ç–∞—Ç–µ–ª–∏ –æ—Ç–º–µ—á–∞—é—Ç –≥–ª—É–±–∏–Ω—É –ø—Ä–æ—Ä–∞–±–æ—Ç–∫–∏ —ç—Ç–æ–≥–æ –∞—Å–ø–µ–∫—Ç–∞.</p>

            <h2>–†–æ–ª—å –≤ —Å—é–∂–µ—Ç–µ</h2>
            <p>–í —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —á–∞—Å—Ç—è—Ö —Å–∞–≥–∏ {topic} –∏–≥—Ä–∞–µ—Ç –≤–∞–∂–Ω—É—é —Ä–æ–ª—å, –≤–ª–∏—è—è –Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ —Å–æ–±—ã—Ç–∏–π –∏ —Å—É–¥—å–±—ã –¥—Ä—É–≥–∏—Ö –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π. –ë–µ–∑ —ç—Ç–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏—Å—Ç–æ—Ä–∏—è –±—ã–ª–∞ –±—ã –Ω–µ–ø–æ–ª–Ω–æ–π.</p>

            <h2>–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Ñ–∞–∫—Ç—ã</h2>
            <ul>
            <li>–§–∞–∫—Ç 1 –æ {topic}</li>
            <li>–ú–∞–ª–æ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –¥–µ—Ç–∞–ª—å –∏–∑ –∫–Ω–∏–≥</li>
            <li>–°–≤—è–∑—å —Å –¥—Ä—É–≥–∏–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –≤—Å–µ–ª–µ–Ω–Ω–æ–π</li>
            </ul>
            """,

            f"""
            <h2>–í–≤–µ–¥–µ–Ω–∏–µ</h2>
            <p>–¢–µ–º–∞ {topic} –≤—Å–µ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–ª–∞ –∏–Ω—Ç–µ—Ä–µ—Å —É —Ñ–∞–Ω–∞—Ç–æ–≤ –≤—Å–µ–ª–µ–Ω–Ω–æ–π –í–µ–¥—å–º–∞–∫–∞. –í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ –º—ã –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –≤—Å–µ –∞—Å–ø–µ–∫—Ç—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –¥–∞–Ω–Ω—ã–º –≤–æ–ø—Ä–æ—Å–æ–º.</p>

            <h2>–ü–æ–¥—Ä–æ–±–Ω—ã–π –∞–Ω–∞–ª–∏–∑</h2>
            <p>–ê–Ω–∞–ª–∏–∑ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ {topic} –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–ª–æ–∂–Ω—É—é —Å–∏—Å—Ç–µ–º—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –∏ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–µ–π. –ü–æ–Ω–∏–º–∞–Ω–∏–µ —ç—Ç–∏—Ö –Ω—é–∞–Ω—Å–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª—É—á—à–µ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –º–∏—Ä–µ –í–µ–¥—å–º–∞–∫–∞.</p>

            <blockquote>
            <p>–¶–∏—Ç–∞—Ç–∞ –∏–∑ –∫–Ω–∏–≥–∏ –∏–ª–∏ –∏–≥—Ä—ã, —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å {topic}</p>
            </blockquote>

            <h2>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ</h2>
            <p>–ó–Ω–∞–Ω–∏–µ –æ {topic} –∏–º–µ–µ—Ç –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∏–≥—Ä–æ–≤–æ–π –º–µ—Ö–∞–Ω–∏–∫–∏ –∏ —Å—é–∂–µ—Ç–Ω—ã—Ö –ø–æ–≤–æ—Ä–æ—Ç–æ–≤.</p>
            """
        ]

        return random.choice(templates)

    def generate_user_bio(self, username):
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –±–∏–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        bios = {
            'geralt_rivia': '–í–µ–¥—å–º–∞–∫ –∏–∑ –®–∫–æ–ª—ã –í–æ–ª–∫–∞. –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Å—å –Ω–∞ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–∏ —á—É–¥–æ–≤–∏—â. –í —Å–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è –∏–≥—Ä–∞—é –≤ –≥–≤–∏–Ω—Ç.',
            'yennefer_vengerberg': '–ß–∞—Ä–æ–¥–µ–π–∫–∞, —á–ª–µ–Ω –°–æ–≤–µ—Ç–∞ —á–∞—Ä–æ–¥–µ–µ–≤. –ò–Ω—Ç–µ—Ä–µ—Å—É—é—Å—å –º–∞–≥–∏–µ–π, –ø–æ–ª–∏—Ç–∏–∫–æ–π –∏ –∏—Å–∫—É—Å—Å—Ç–≤–æ–º.',
            'ciri_fiona': '–î–∏—Ç—è –°—Ç–∞—Ä—à–µ–π –ö—Ä–æ–≤–∏, –ø—Ä–∏–Ω—Ü–µ—Å—Å–∞ –¶–∏–Ω—Ç—Ä—ã. –ü—É—Ç–µ—à–µ—Å—Ç–≤—É—é –º–µ–∂–¥—É –º–∏—Ä–∞–º–∏.',
            'triss_merigold': '–ß–∞—Ä–æ–¥–µ–π–∫–∞, —Å–æ–≤–µ—Ç–Ω–∏–∫ –∫–æ—Ä–æ–ª—è –§–æ–ª—å—Ç–µ—Å—Ç–∞. –õ—é–±–ª—é –ø–æ–º–æ–≥–∞—Ç—å –ª—é–¥—è–º.',
            'vesemir': '–°—Ç–∞—Ä–µ–π—à–∏–π –≤–µ–¥—å–º–∞–∫, –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫ –º–æ–ª–æ–¥—ã—Ö. –ñ–∏–≤—É –≤ –ö–∞—ç—Ä –ú–æ—Ä—Ö–µ–Ω–µ.',
            'dandelion': '–ë–∞—Ä–¥, –ø–æ—ç—Ç, –¥—Ä—É–≥ –≤–µ–¥—å–º–∞–∫–∞. –ü–∏—à—É –±–∞–ª–ª–∞–¥—ã –æ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö.',
            'zoltan_chivay': '–ì–Ω–æ–º, —Ç–æ—Ä–≥–æ–≤–µ—Ü, –≤–ª–∞–¥–µ–ª–µ—Ü —Ç–∞–≤–µ—Ä–Ω—ã. –ó–Ω–∞—é –≤—Å—ë –æ –ø–æ–¥–∑–µ–º–Ω–æ–π –∂–∏–∑–Ω–∏.',
            'keira_metz': '–ß–∞—Ä–æ–¥–µ–π–∫–∞, –±—ã–≤—à–∏–π –ø—Ä–∏–¥–≤–æ—Ä–Ω—ã–π –º–∞–≥. –°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –¥—Ä–µ–≤–Ω–∏–º –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞–º.',
            'regis': '–í—ã—Å—à–∏–π –≤–∞–º–ø–∏—Ä, —Ç—Ä–∞–≤–Ω–∏–∫. –ò–Ω—Ç–µ—Ä–µ—Å—É—é—Å—å –∞–ª—Ö–∏–º–∏–µ–π –∏ –º–µ–¥–∏—Ü–∏–Ω–æ–π.',
            'vilgefortz': '–ß–∞—Ä–æ–¥–µ–π, —á–ª–µ–Ω –°–æ–≤–µ—Ç–∞. –ò–∑—É—á–∞—é –ø—Ä–µ–¥–µ–ª—ã –º–∞–≥–∏—á–µ—Å–∫–∏—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π.',
        }

        return bios.get(username, '–ü–æ–∫–ª–æ–Ω–Ω–∏–∫ –≤—Å–µ–ª–µ–Ω–Ω–æ–π –í–µ–¥—å–º–∞–∫–∞. –õ—é–±–ª—é –∫–Ω–∏–≥–∏, –∏–≥—Ä—ã –∏ —Å–µ—Ä–∏–∞–ª.')

    def slugify(self, text):
        """–ü—Ä–æ—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è slug"""
        import re
        text = text.lower()
        text = re.sub(r'[^\w\s-]', '', text)
        text = re.sub(r'[-\s]+', '-', text)
        return text.strip('-')

    def print_statistics(self, categories, users, articles, comments):
        """–í—ã–≤–æ–¥–∏—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö"""
        self.stdout.write("\n" + "=" * 50)
        self.stdout.write("üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –°–û–ó–î–ê–ù–ù–´–• –î–ê–ù–ù–´–•")
        self.stdout.write("=" * 50)

        # –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –ª–∞–π–∫–∏ —Å—Ç–∞—Ç–µ–π
        article_likes = ArticleLike.objects.count()

        # –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –ª–∞–π–∫–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
        comment_likes = CommentLike.objects.count()

        # –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å –æ—Ç–≤–µ—Ç–∞–º–∏
        replies = Comment.objects.filter(parent__isnull=False).count()

        # –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —Å—Ç–∞—Ç—å–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
        articles_by_category = {}
        for article in articles:
            for category in article.categories.all():
                articles_by_category[category.name] = articles_by_category.get(category.name, 0) + 1

        self.stdout.write(f"üìö –ö–∞—Ç–µ–≥–æ—Ä–∏–∏: {len(categories)}")
        for category_name, count in articles_by_category.items():
            self.stdout.write(f"   - {category_name}: {count} —Å—Ç–∞—Ç–µ–π")

        self.stdout.write(f"üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: {len(users)}")
        self.stdout.write(f"üìù –í—Å–µ–≥–æ —Å—Ç–∞—Ç–µ–π: {len(articles)}")
        self.stdout.write(f"üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏: {len(comments)} (–∏–∑ –Ω–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤: {replies})")
        self.stdout.write(f"‚ù§Ô∏è –õ–∞–π–∫–∏ —Å—Ç–∞—Ç–µ–π: {article_likes}")
        self.stdout.write(f"üëç –õ–∞–π–∫–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤: {comment_likes}")

        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º —Å—Ç–∞—Ç–µ–π
        status_stats = {}
        for article in articles:
            status_stats[article.status] = status_stats.get(article.status, 0) + 1

        self.stdout.write("\nüìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º —Å—Ç–∞—Ç–µ–π:")
        for status, count in status_stats.items():
            status_display = dict(Article.STATUS_CHOICES).get(status, status)
            self.stdout.write(f"   - {status_display}: {count}")

        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞–º
        total_views = sum(article.views_count for article in articles)
        avg_views = total_views / len(articles) if articles else 0
        self.stdout.write(f"\nüëÅÔ∏è –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤: {total_views}")
        self.stdout.write(f"üìä –°—Ä–µ–¥–Ω–µ–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –Ω–∞ —Å—Ç–∞—Ç—å—é: {avg_views:.1f}")

        self.stdout.write("\n" + "=" * 50)
        self.stdout.write("‚úÖ –¢–µ—Å—Ç–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ–∑–¥–∞–Ω—ã —Å –ø–∞—Ä–æ–ª–µ–º: testpass123")
        self.stdout.write("=" * 50)