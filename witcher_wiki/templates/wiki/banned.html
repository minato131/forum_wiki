{% extends 'base.html' %}
{% load static %}

{% block title %}–ê–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω{% endblock %}

{% block content %}
<!-- –ò—Å–ø–æ–ª—å–∑—É–µ–º flexbox –¥–ª—è —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ –≤—Å–µ–π –≤—ã—Å–æ—Ç—É —ç–∫—Ä–∞–Ω–∞ -->
<div class="d-flex align-items-center justify-content-center min-vh-100">
    <div class="col-md-8 col-lg-6">
        <div class="banned-card text-center">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
            <div class="banned-header">
                <div class="banned-icon">
                    <i class="fas fa-ban"></i>
                </div>
                <h1 class="banned-title">üö´ –ê–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</h1>
            </div>

            <!-- –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ -->
            <div class="banned-body">
                {% if ban %}
                    <div class="alert alert-danger">
                        <h4><i class="fas fa-exclamation-triangle"></i> –í–∞—à –∞–∫–∫–∞—É–Ω—Ç –±—ã–ª –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</h4>
                        <p><strong>–ü—Ä–∏—á–∏–Ω–∞:</strong> {{ ban.reason|default:"–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª —Å–æ–æ–±—â–µ—Å—Ç–≤–∞" }}</p>
                        <p><strong>–î–∞—Ç–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:</strong> {{ ban.created_at|date:"d.m.Y H:i" }}</p>

                        {% if ban.duration == 'permanent' %}
                            <p class="text-danger"><strong>–¢–∏–ø –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:</strong> –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞</p>
                        {% else %}
                            <p><strong>–°—Ä–æ–∫ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:</strong> {{ ban.get_duration_display }}</p>
                            {% if time_remaining %}
                                <p><strong>–û—Å—Ç–∞–ª–æ—Å—å –≤—Ä–µ–º–µ–Ω–∏:</strong>
                                    {% if time_remaining.days > 0 %}
                                        {{ time_remaining.days }} –¥–Ω–µ–π
                                    {% else %}
                                        {{ time_remaining.seconds|divisibleby:3600|yesno:"—á–∞—Å—ã,–º–∏–Ω—É—Ç—ã" }}
                                    {% endif %}
                                </p>
                            {% endif %}
                        {% endif %}

                        {% if ban.moderator_notes %}
                            <div class="moderator-notes">
                                <p><strong>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞:</strong></p>
                                <p>{{ ban.moderator_notes }}</p>
                            </div>
                        {% endif %}
                    </div>
                {% else %}
                    <div class="alert alert-warning">
                        <h4><i class="fas fa-exclamation-circle"></i> –î–æ—Å—Ç—É–ø –æ–≥—Ä–∞–Ω–∏—á–µ–Ω</h4>
                        <p>–í–∞—à –∞–∫–∫–∞—É–Ω—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –∑–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª —Å–æ–æ–±—â–µ—Å—Ç–≤–∞.</p>
                    </div>
                {% endif %}

                <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è—Ö -->
                <div class="consequences">
                    <h5><i class="fas fa-times-circle"></i> –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:</h5>
                    <ul class="list-unstyled">
                        <li><i class="fas fa-times text-danger"></i> –ù–µ–ª—å–∑—è —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Å—Ç–∞—Ç—å–∏</li>
                        <li><i class="fas fa-times text-danger"></i> –ù–µ–ª—å–∑—è –æ—Å—Ç–∞–≤–ª—è—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</li>
                        <li><i class="fas fa-times text-danger"></i> –ù–µ–ª—å–∑—è —Å—Ç–∞–≤–∏—Ç—å –ª–∞–π–∫–∏</li>
                        <li><i class="fas fa-times text-danger"></i> –û–≥—Ä–∞–Ω–∏—á–µ–Ω –¥–æ—Å—Ç—É–ø –∫ –Ω–µ–∫–æ—Ç–æ—Ä—ã–º —Ä–∞–∑–¥–µ–ª–∞–º</li>
                    </ul>
                </div>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
            <div class="banned-footer">
                {% if not is_permanent and time_remaining %}
                    <div class="countdown mb-3">
                        <p class="text-info">
                            <i class="fas fa-clock"></i>
                            –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –±—É–¥–µ—Ç —Å–Ω—è—Ç–∞ —á–µ—Ä–µ–∑:
                            <strong id="countdown-timer">{{ time_remaining.total_seconds|floatformat:0 }}</strong> —Å–µ–∫—É–Ω–¥
                        </p>
                    </div>
                {% endif %}

                <div class="action-buttons">
                    <!-- –ö–Ω–æ–ø–∫–∞ –≤—ã—Ö–æ–¥–∞ - –ü–†–û–°–¢–û–ô –†–ê–ë–û–ß–ò–ô –í–ê–†–ò–ê–ù–¢ -->
                    <form method="POST" action="/accounts/logout/" style="display: inline;">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger btn-lg">
                            <i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
                        </button>
                    </form>

                    <!-- –ö–Ω–æ–ø–∫–∞ –Ω–∞ –≥–ª–∞–≤–Ω—É—é -->
                    <a href="/" class="btn btn-secondary btn-lg">
                        <i class="fas fa-home"></i> –ù–∞ –≥–ª–∞–≤–Ω—É—é
                    </a>
                </div>

                <!-- –ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è –∞–ø–µ–ª–ª—è—Ü–∏–∏ -->
                <div class="appeal-info mt-3">
                    <p class="text-muted small">
                        –ï—Å–ª–∏ –≤—ã —Å—á–∏—Ç–∞–µ—Ç–µ, —á—Ç–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –±—ã–ª–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –ø–æ –æ—à–∏–±–∫–µ,
                        —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–µ–π
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
/* –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã—Å–æ—Ç—É –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
.min-vh-100 {
    min-height: 100vh;
    padding: 20px;
}

/* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –∫–∞—Ä—Ç–æ—á–∫–∏ */
.banned-card {
    background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
    border: 2px solid #dc3545;
    border-radius: 15px;
    padding: 40px 30px;
    width: 100%;
    margin: 0 auto;
}

.banned-header {
    margin-bottom: 30px;
}

.banned-icon {
    font-size: 4em;
    color: #dc3545;
    margin-bottom: 15px;
}

.banned-title {
    color: #dc3545;
    font-family: 'Cinzel', serif;
    font-size: 2.2em;
    margin-bottom: 10px;
}

.banned-body {
    margin-bottom: 30px;
    text-align: left;
}

.alert {
    border-radius: 10px;
    border: 1px solid;
    padding: 20px;
}

.alert-danger {
    background-color: rgba(220, 53, 69, 0.1);
    border-color: #dc3545;
    color: #f8d7da;
}

.alert-warning {
    background-color: rgba(255, 193, 7, 0.1);
    border-color: #ffc107;
    color: #fff3cd;
}

.moderator-notes {
    background: rgba(0, 0, 0, 0.2);
    border-left: 4px solid #D4AF37;
    padding: 10px 15px;
    margin-top: 15px;
    border-radius: 5px;
}

.consequences {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 10px;
    padding: 20px;
    margin-top: 20px;
    border: 1px solid #444;
}

.consequences h5 {
    color: #D4AF37;
    margin-bottom: 15px;
    font-family: 'Cinzel', serif;
}

.consequences ul {
    margin: 0;
    padding: 0;
}

.consequences li {
    padding: 8px 0;
    color: #e8e8e8;
    border-bottom: 1px solid #333;
}

.consequences li:last-child {
    border-bottom: none;
}

.consequences i {
    margin-right: 10px;
}

.banned-footer {
    padding-top: 20px;
    border-top: 1px solid #444;
}

.countdown {
    font-size: 1.1em;
    padding: 10px 15px;
    background: rgba(23, 162, 184, 0.1);
    border-radius: 8px;
    border: 1px solid rgba(23, 162, 184, 0.3);
}

.action-buttons {
    display: flex;
    gap: 15px;
    justify-content: center;
    flex-wrap: wrap;
    margin: 20px 0;
}

.btn-lg {
    padding: 12px 30px;
    font-size: 1.1em;
    border-radius: 10px;
    min-width: 200px;
    cursor: pointer;
    border: none;
    text-decoration: none;
    display: inline-block;
    text-align: center;
}

.btn-danger {
    background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
    color: white;
}

.btn-danger:hover {
    background: linear-gradient(135deg, #c82333 0%, #bd2130 100%);
    color: white;
    text-decoration: none;
}

.btn-secondary {
    background: linear-gradient(135deg, #6c757d 0%, #545b62 100%);
    color: white;
}

.btn-secondary:hover {
    background: linear-gradient(135deg, #545b62 0%, #4a5056 100%);
    color: white;
    text-decoration: none;
}

.appeal-info {
    background: rgba(0, 0, 0, 0.1);
    padding: 15px;
    border-radius: 8px;
    border: 1px solid #444;
}

@media (max-width: 768px) {
    .min-vh-100 {
        padding: 10px;
    }

    .banned-card {
        padding: 25px 20px;
    }

    .banned-title {
        font-size: 1.8em;
    }

    .action-buttons {
        flex-direction: column;
        align-items: center;
    }

    .btn-lg {
        width: 100%;
        max-width: 300px;
    }
}

@media (max-width: 576px) {
    .banned-card {
        padding: 20px 15px;
    }

    .banned-title {
        font-size: 1.5em;
    }

    .btn-lg {
        min-width: auto;
        width: 100%;
    }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // –¢–∞–π–º–µ—Ä –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –æ—Ç—Å—á–µ—Ç–∞
    const countdownElement = document.getElementById('countdown-timer');

    if (countdownElement) {
        let totalSeconds = parseInt(countdownElement.textContent);

        const countdownTimer = setInterval(function() {
            if (totalSeconds <= 0) {
                clearInterval(countdownTimer);
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                countdownElement.innerHTML = '<span class="text-success">–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–Ω—è—Ç–∞! –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É...</span>';
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–∏ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –±–∞–Ω–∞
                setTimeout(() => {
                    window.location.reload();
                }, 2000);
                return;
            }

            totalSeconds--;

            // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
            const days = Math.floor(totalSeconds / (3600 * 24));
            const hours = Math.floor((totalSeconds % (3600 * 24)) / 3600);
            const minutes = Math.floor((totalSeconds % 3600) / 60);
            const seconds = totalSeconds % 60;

            let timeString = '';
            if (days > 0) {
                timeString = `${days}–¥ ${hours.toString().padStart(2, '0')}—á ${minutes.toString().padStart(2, '0')}–º ${seconds.toString().padStart(2, '0')}—Å`;
            } else if (hours > 0) {
                timeString = `${hours}—á ${minutes.toString().padStart(2, '0')}–º ${seconds.toString().padStart(2, '0')}—Å`;
            } else if (minutes > 0) {
                timeString = `${minutes}–º ${seconds.toString().padStart(2, '0')}—Å`;
            } else {
                timeString = `${seconds}—Å`;
            }

            countdownElement.textContent = timeString;
        }, 1000);
    }

    // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
    const bannedCard = document.querySelector('.banned-card');
    if (bannedCard) {
        bannedCard.style.opacity = '0';
        bannedCard.style.transform = 'translateY(30px)';

        setTimeout(() => {
            bannedCard.style.transition = 'opacity 0.8s ease, transform 0.8s ease';
            bannedCard.style.opacity = '1';
            bannedCard.style.transform = 'translateY(0)';
        }, 100);
    }

    // –û—Ç–ª–∞–¥–∫–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã –∫–Ω–æ–ø–æ–∫
    console.log('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∑–∞–≥—Ä—É–∂–µ–Ω–∞');

    // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –∫–ª–∏–∫–∏ –ø–æ –∫–Ω–æ–ø–∫–∞–º
    const logoutButton = document.querySelector('button[type="submit"]');
    if (logoutButton) {
        logoutButton.addEventListener('click', function(e) {
            console.log('–ö–Ω–æ–ø–∫–∞ "–í—ã–π—Ç–∏" –Ω–∞–∂–∞—Ç–∞');
            console.log('–§–æ—Ä–º–∞ action:', this.form.action);
        });
    }

    const homeButton = document.querySelector('a.btn-secondary');
    if (homeButton) {
        homeButton.addEventListener('click', function(e) {
            console.log('–ö–Ω–æ–ø–∫–∞ "–ù–∞ –≥–ª–∞–≤–Ω—É—é" –Ω–∞–∂–∞—Ç–∞');
            console.log('URL:', this.href);
        });
    }
});
</script>
{% endblock %}