<!-- wiki/templates/wiki/user_statistics.html -->
{% extends "base.html" %}
{% load static %}

{% block title %}–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ {{ profile_user.username }}{% endblock %}

{% block content %}
<div style="background: #1a1a1a; color: white; padding: 30px; border-radius: 15px; border: 2px solid #D4AF37; max-width: 1200px; margin: 0 auto;">

    <!-- –®–∞–ø–∫–∞ -->
    <div style="text-align: center; margin-bottom: 40px; padding-bottom: 20px; border-bottom: 2px solid #D4AF37;">
        <h1 style="color: #D4AF37; font-size: 2.5em; margin: 0 0 10px 0;">üìä {{ profile_user.username }}</h1>
        <div style="color: #888; font-size: 1.1em;">
            <span>–£—Ä–æ–≤–µ–Ω—å:
                {% if total_articles > 50 %}–ú–∞—Å—Ç–µ—Ä
                {% elif total_articles > 20 %}–û–ø—ã—Ç–Ω—ã–π
                {% elif total_articles > 5 %}–ù–æ–≤–∏—á–æ–∫
                {% else %}–ù–∞—á–∏–Ω–∞—é—â–∏–π
                {% endif %}
            </span>
            ‚Ä¢
            <span>–ù–∞ —Å–∞–π—Ç–µ —Å: {{ profile_user.date_joined|date:"d.m.Y" }}</span>
        </div>
    </div>

    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 40px;">
        <div style="background: #2d2d2d; border: 1px solid #444; border-radius: 10px; padding: 25px; text-align: center;">
            <div style="font-size: 2em; color: #D4AF37; margin-bottom: 15px;">üìù</div>
            <div style="font-size: 2.5em; font-weight: bold; color: #D4AF37; margin: 10px 0;">{{ total_articles }}</div>
            <div style="color: #aaa; font-size: 0.9em; text-transform: uppercase;">–°—Ç–∞—Ç–µ–π</div>
        </div>

        <div style="background: #2d2d2d; border: 1px solid #444; border-radius: 10px; padding: 25px; text-align: center;">
            <div style="font-size: 2em; color: #D4AF37; margin-bottom: 15px;">üí¨</div>
            <div style="font-size: 2.5em; font-weight: bold; color: #D4AF37; margin: 10px 0;">{{ total_comments }}</div>
            <div style="color: #aaa; font-size: 0.9em; text-transform: uppercase;">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤</div>
        </div>

        <div style="background: #2d2d2d; border: 1px solid #444; border-radius: 10px; padding: 25px; text-align: center;">
            <div style="font-size: 2em; color: #D4AF37; margin-bottom: 15px;">üëÅÔ∏è</div>
            <div style="font-size: 2.5em; font-weight: bold; color: #D4AF37; margin: 10px 0;">{{ total_views }}</div>
            <div style="color: #aaa; font-size: 0.9em; text-transform: uppercase;">–ü—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</div>
        </div>

        <div style="background: #2d2d2d; border: 1px solid #444; border-radius: 10px; padding: 25px; text-align: center;">
            <div style="font-size: 2em; color: #D4AF37; margin-bottom: 15px;">‚ù§Ô∏è</div>
            <div style="font-size: 2.5em; font-weight: bold; color: #D4AF37; margin: 10px 0;">{{ total_likes }}</div>
            <div style="color: #aaa; font-size: 0.9em; text-transform: uppercase;">–õ–∞–π–∫–æ–≤</div>
        </div>
    </div>

    <!-- –°—Ç–∞—Ç—å–∏ -->
    <div style="background: #2d2d2d; border: 1px solid #444; border-radius: 10px; padding: 25px; margin-bottom: 30px;">
        <h2 style="color: #D4AF37; font-size: 1.8em; margin: 0 0 20px 0; border-bottom: 2px solid #D4AF37; padding-bottom: 10px;">
            üìà –¢–æ–ø –≤–∞—à–∏—Ö —Å—Ç–∞—Ç–µ–π
        </h2>

        <div style="display: flex; gap: 10px; margin-bottom: 20px;">
            <a href="?filter=views"
               style="padding: 10px 20px; border: 1px solid #D4AF37; background: {% if current_filter == 'views' %}#D4AF37{% else %}transparent{% endif %};
                      color: {% if current_filter == 'views' %}#1a1a1a{% else %}#D4AF37{% endif %}; border-radius: 5px; text-decoration: none;">
                –ü–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞–º
            </a>
            <a href="?filter=likes"
               style="padding: 10px 20px; border: 1px solid #D4AF37; background: {% if current_filter == 'likes' %}#D4AF37{% else %}transparent{% endif %};
                      color: {% if current_filter == 'likes' %}#1a1a1a{% else %}#D4AF37{% endif %}; border-radius: 5px; text-decoration: none;">
                –ü–æ –ª–∞–π–∫–∞–º
            </a>
            <a href="?filter=date"
               style="padding: 10px 20px; border: 1px solid #D4AF37; background: {% if current_filter == 'date' %}#D4AF37{% else %}transparent{% endif %};
                      color: {% if current_filter == 'date' %}#1a1a1a{% else %}#D4AF37{% endif %}; border-radius: 5px; text-decoration: none;">
                –ü–æ –¥–∞—Ç–µ
            </a>
        </div>

        {% for article in top_articles %}
        <div style="background: rgba(255,255,255,0.05); border: 1px solid #444; border-radius: 8px; padding: 15px; margin-bottom: 10px;">
            <h3 style="color: #D4AF37; font-size: 1.2em; margin: 0 0 10px 0;">
                <a href="{{ article.get_absolute_url }}" style="color: inherit; text-decoration: none;">{{ article.title }}</a>
            </h3>
            <div style="color: #888; font-size: 0.9em; display: flex; gap: 20px;">
                <span>üìÖ {{ article.created_at|date:"d.m.Y" }}</span>
                {% if article.categories.exists %}
                <span>üìÇ
                    {% for cat in article.categories.all|slice:":2" %}
                        {{ cat.name }}{% if not forloop.last %}, {% endif %}
                    {% endfor %}
                </span>
                {% endif %}
                <span>üëÅÔ∏è {{ article.views_count }}</span>
                <span>‚ù§Ô∏è {{ article.likes }}</span>
            </div>
        </div>
        {% empty %}
        <div style="text-align: center; padding: 40px; color: #888;">
            <p style="font-size: 1.2em;">üìù –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å—Ç–∞—Ç–µ–π</p>
            <a href="{% url 'wiki:article_create' %}" style="color: #D4AF37; font-weight: bold;">
                –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—É—é —Å—Ç–∞—Ç—å—é
            </a>
        </div>
        {% endfor %}
    </div>

    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div style="display: flex; justify-content: center; gap: 20px; margin-top: 40px;">
        {% if request.user == profile_user %}
        <a href="{% url 'wiki:user_public_profile' profile_user.username %}"
           style="padding: 12px 25px; border: 2px solid #D4AF37; background: transparent; color: #D4AF37; text-decoration: none; border-radius: 5px; font-weight: bold;">
            üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å
        </a>
        <a href="{% url 'wiki:article_create' %}"
           style="padding: 12px 25px; background: #D4AF37; color: #1a1a1a; text-decoration: none; border-radius: 5px; font-weight: bold;">
            ‚úèÔ∏è –ù–æ–≤–∞—è —Å—Ç–∞—Ç—å—è
        </a>
        {% else %}
        <a href="{% url 'wiki:user_public_profile' profile_user.username %}"
           style="padding: 12px 25px; border: 2px solid #D4AF37; background: transparent; color: #D4AF37; text-decoration: none; border-radius: 5px; font-weight: bold;">
            üë§ –ü—Ä–æ—Ñ–∏–ª—å {{ profile_user.username }}
        </a>
        <a href="{% url 'wiki:home' %}"
           style="padding: 12px 25px; background: #D4AF37; color: #1a1a1a; text-decoration: none; border-radius: 5px; font-weight: bold;">
            üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é
        </a>
        {% endif %}
    </div>
</div>

<script>
    // –ü—Ä–æ—Å—Ç—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏
    document.addEventListener('DOMContentLoaded', function() {
        // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∏
        const cards = document.querySelectorAll('[style*="background: #2d2d2d"]');
        cards.forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.borderColor = '#D4AF37';
                this.style.transform = 'translateY(-5px)';
                this.style.transition = 'all 0.3s';
            });

            card.addEventListener('mouseleave', function() {
                this.style.borderColor = '#444';
                this.style.transform = 'translateY(0)';
            });
        });

        // –ê–Ω–∏–º–∞—Ü–∏—è —Å—á–µ—Ç—á–∏–∫–æ–≤
        const counters = document.querySelectorAll('[style*="font-size: 2.5em"]');
        counters.forEach(counter => {
            const target = parseInt(counter.textContent) || 0;
            if (target > 0) {
                let current = 0;
                const increment = target / 50;
                const timer = setInterval(() => {
                    current += increment;
                    if (current >= target) {
                        counter.textContent = target;
                        clearInterval(timer);
                    } else {
                        counter.textContent = Math.floor(current);
                    }
                }, 30);
            }
        });
    });
</script>
{% endblock %}