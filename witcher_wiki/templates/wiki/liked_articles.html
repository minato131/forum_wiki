{% extends 'base.html' %}
{% load static %}

{% block title %}–ü–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è —Å—Ç–∞—Ç—å–∏ - –§–æ—Ä—É–º –ø–æ –í—Å–µ–ª–µ–Ω–Ω–æ–π –í–µ–¥—å–º–∞–∫–∞{% endblock %}

{% block content %}
<div class="liked-articles-container">
    <div class="page-header">
        <h1>‚ù§Ô∏è –ü–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è —Å—Ç–∞—Ç—å–∏</h1>
        <p class="page-subtitle">–°—Ç–∞—Ç—å–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤–∞–º –ø–æ–Ω—Ä–∞–≤–∏–ª–∏—Å—å</p>
    </div>

    {% if articles %}
    <div class="articles-stats">
        <div class="stat-badge">
            <span class="stat-number">{{ total_count }}</span>
            <span class="stat-label">–≤—Å–µ–≥–æ —Å—Ç–∞—Ç–µ–π</span>
        </div>
         {% csrf_token %}
    </div>

    <div class="articles-grid">
{% for article in articles %}
<div class="article-card liked-article-card">
    <div class="article-header">
        <h3 class="article-title">
            <a href="{% url 'wiki:article_detail' article.slug %}">{{ article.title }}</a>
        </h3>
        <button class="like-btn active"
                data-article-slug="{{ article.slug }}"
                data-article-title="{{ article.title }}"
                onclick="confirmUnlike('{{ article.slug }}', '{{ article.title|escapejs }}')"
                title="–£–±—Ä–∞—Ç—å –ª–∞–π–∫">
            ‚ù§Ô∏è
        </button>
    </div>

    <div class="article-meta">
        <span class="meta-item">
            üë§ <a href="{% url 'wiki:user_public_profile' article.author.username %}">{{ article.author.username }}</a>
        </span>
        <span class="meta-item">üìÖ {{ article.created_at|date:"d.m.Y" }}</span>
        <span class="meta-item">üëÅÔ∏è {{ article.views_count|default:0 }}</span>
        <span class="meta-item">
            ‚ù§Ô∏è {{ article.get_likes_count|default:0 }}
        </span>
    </div>

    {% if article.excerpt %}
    <p class="article-excerpt">{{ article.excerpt|truncatewords:30 }}</p>
    {% endif %}

    <div class="article-categories">
        {% for category in article.categories.all %}
        <span class="category-tag">{{ category.name }}</span>
        {% endfor %}
    </div>

    <div class="article-actions">
    <a href="{% url 'wiki:article_detail' article.slug %}" class="btn-read">üìñ –ß–∏—Ç–∞—Ç—å</a>
    <button class="btn-unlike"
            data-article-slug="{{ article.slug }}"
            data-article-title="{{ article.title|escapejs }}"
            onclick="confirmUnlike('{{ article.slug }}', '{{ article.title|escapejs }}')">
        üóëÔ∏è –£–±—Ä–∞—Ç—å –ª–∞–π–∫
    </button>
</div>
</div>
{% endfor %}
    </div>

    <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
    {% if articles.has_other_pages %}
    <div class="pagination">
        {% if articles.has_previous %}
            <a href="?page={{ articles.previous_page_number }}" class="page-link">‚Üê –ù–∞–∑–∞–¥</a>
        {% endif %}

        <span class="current-page">
            –°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ articles.number }} –∏–∑ {{ articles.paginator.num_pages }}
        </span>

        {% if articles.has_next %}
            <a href="?page={{ articles.next_page_number }}" class="page-link">–í–ø–µ—Ä–µ–¥ ‚Üí</a>
        {% endif %}
    </div>
    {% endif %}

    {% else %}
    <div class="empty-state">
        <div class="empty-icon">‚ù§Ô∏è</div>
        <h3>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø–æ–Ω—Ä–∞–≤–∏–≤—à–∏—Ö—Å—è —Å—Ç–∞—Ç–µ–π</h3>
        <p>–ö–æ–≥–¥–∞ –≤—ã –±—É–¥–µ—Ç–µ —Å—Ç–∞–≤–∏—Ç—å –ª–∞–π–∫–∏ —Å—Ç–∞—Ç—å—è–º, –æ–Ω–∏ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å.</p>
        <div class="empty-actions">
            <a href="{% url 'wiki:home' %}" class="btn btn-primary">üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
            <a href="{% url 'wiki:search' %}" class="btn btn-outline">üîç –ù–∞–π—Ç–∏ —Å—Ç–∞—Ç—å–∏</a>
        </div>
    </div>
    {% endif %}
</div>

<style>
.liked-articles-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

.page-header {
    text-align: center;
    margin-bottom: 40px;
}

.page-header h1 {
    color: #D4AF37;
    font-family: 'Cinzel', serif;
    font-size: 2.5em;
    margin-bottom: 10px;
}

.page-subtitle {
    color: #e8e8e8;
    font-size: 1.1em;
    opacity: 0.8;
}

.articles-stats {
    display: flex;
    justify-content: center;
    margin-bottom: 30px;
}

.stat-badge {
    background: rgba(220, 53, 69, 0.2);
    border: 2px solid #dc3545;
    border-radius: 20px;
    padding: 10px 20px;
    text-align: center;
}

.stat-number {
    display: block;
    font-size: 1.5em;
    font-weight: bold;
    color: #dc3545;
}

.stat-label {
    font-size: 0.9em;
    color: #e8e8e8;
}

.articles-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: 25px;
    margin-bottom: 40px;
}

.article-card {
    background: linear-gradient(135deg, #2d2d2d 0%, #1a1a1a 100%);
    border: 1px solid #444;
    border-radius: 15px;
    padding: 25px;
    transition: all 0.3s ease;
    position: relative;
}

.liked-article-card {
    border-left: 4px solid #dc3545;
}

.article-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 30px rgba(220, 53, 69, 0.2);
    border-color: #dc3545;
}

.article-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 15px;
}

.article-title {
    flex: 1;
    margin: 0;
}

.article-title a {
    color: #D4AF37;
    text-decoration: none;
    font-size: 1.2em;
    line-height: 1.3;
}

.article-title a:hover {
    color: #FFD700;
    text-decoration: underline;
}

.like-btn {
    background: none;
    border: none;
    font-size: 1.5em;
    cursor: pointer;
    padding: 5px;
    border-radius: 50%;
    transition: all 0.3s;
    margin-left: 10px;
}

.like-btn.active {
    color: #dc3545;
}

.like-btn:hover {
    transform: scale(1.2);
}

.article-meta {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    margin-bottom: 15px;
    font-size: 0.85em;
}

.meta-item {
    color: #888;
    display: flex;
    align-items: center;
    gap: 5px;
}

.meta-item a {
    color: #D4AF37;
    text-decoration: none;
}

.meta-item a:hover {
    text-decoration: underline;
}

.article-excerpt {
    color: #e8e8e8;
    line-height: 1.5;
    margin-bottom: 15px;
    font-size: 0.95em;
}

.article-categories {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-bottom: 20px;
}

.category-tag {
    background: rgba(212, 175, 55, 0.1);
    color: #D4AF37;
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 0.8em;
    border: 1px solid #D4AF37;
}

.article-actions {
    display: flex;
    gap: 10px;
    justify-content: space-between;
}

.btn-read {
    background: #D4AF37;
    color: #1a1a1a;
    padding: 8px 16px;
    border-radius: 6px;
    text-decoration: none;
    font-weight: bold;
    transition: all 0.3s;
    flex: 1;
    text-align: center;
}

.btn-read:hover {
    background: #FFD700;
    transform: translateY(-2px);
}

.btn-unlike {
    background: rgba(220, 53, 69, 0.2);
    color: #dc3545;
    border: 1px solid #dc3545;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.3s;
    flex: 1;
}

.btn-unlike:hover {
    background: #dc3545;
    color: white;
    transform: translateY(-2px);
}

.pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 15px;
    margin-top: 40px;
}

.page-link {
    background: rgba(212, 175, 55, 0.1);
    color: #D4AF37;
    padding: 10px 20px;
    border-radius: 8px;
    text-decoration: none;
    border: 1px solid #D4AF37;
    transition: all 0.3s;
}

.page-link:hover {
    background: #D4AF37;
    color: #1a1a1a;
}

.current-page {
    color: #e8e8e8;
    font-weight: bold;
}

.empty-state {
    text-align: center;
    padding: 60px 20px;
    background: #2d2d2d;
    border-radius: 15px;
    border: 2px solid #444;
}

.empty-icon {
    font-size: 4em;
    margin-bottom: 20px;
}

.empty-state h3 {
    color: #D4AF37;
    margin-bottom: 15px;
}

.empty-state p {
    color: #e8e8e8;
    margin-bottom: 30px;
    font-size: 1.1em;
}

.empty-actions {
    display: flex;
    gap: 15px;
    justify-content: center;
    flex-wrap: wrap;
}

.btn {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 12px 25px;
    border-radius: 8px;
    text-decoration: none;
    font-weight: bold;
    transition: all 0.3s;
}

.btn-primary {
    background: #D4AF37;
    color: #1a1a1a;
}

.btn-primary:hover {
    background: #FFD700;
    transform: translateY(-2px);
}

.btn-outline {
    background: transparent;
    color: #D4AF37;
    border: 2px solid #D4AF37;
}

.btn-outline:hover {
    background: #D4AF37;
    color: #1a1a1a;
    transform: translateY(-2px);
}

@media (max-width: 768px) {
    .articles-grid {
        grid-template-columns: 1fr;
    }

    .article-header {
        flex-direction: column;
        gap: 10px;
    }

    .like-btn {
        align-self: flex-end;
    }

    .article-actions {
        flex-direction: column;
    }

    .empty-actions {
        flex-direction: column;
        align-items: center;
    }

    .btn {
        width: 100%;
        justify-content: center;
    }
}
</style>

<script>
// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è –ª–∞–π–∫–∞
function confirmUnlike(articleSlug, articleTitle) {
    if (confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–±—Ä–∞—Ç—å –ª–∞–π–∫ —Å–æ —Å—Ç–∞—Ç—å–∏ "${articleTitle}"?`)) {
        removeLike(articleSlug);
    }
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –ª–∞–π–∫–∞ —á–µ—Ä–µ–∑ AJAX
function removeLike(articleSlug) {
    // –ü–æ–ª—É—á–∞–µ–º CSRF —Ç–æ–∫–µ–Ω
    const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]')?.value;

    if (!csrfToken) {
        alert('–û—à–∏–±–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
        return;
    }

    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
    showLoadingIndicator();

    // –°–æ–∑–¥–∞–µ–º FormData –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ CSRF
    const formData = new FormData();
    formData.append('csrfmiddlewaretoken', csrfToken);

    fetch(`/article/${articleSlug}/like/`, {
        method: 'POST',
        headers: {
            'X-CSRFToken': csrfToken,
            'X-Requested-With': 'XMLHttpRequest',
        },
        body: formData,
        credentials: 'same-origin'
    })
    .then(response => {
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        return response.json();
    })
    .then(data => {
        console.log('Unlike response:', data);
        if (data.success) {
            // –ï—Å–ª–∏ –ª–∞–π–∫ —É—Å–ø–µ—à–Ω–æ —É–±—Ä–∞–Ω - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
            setTimeout(() => {
                window.location.reload();
            }, 500); // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è UX
        } else {
            hideLoadingIndicator();
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ª–∞–π–∫–∞: ' + (data.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
        }
    })
    .catch(error => {
        console.error('Error:', error);
        hideLoadingIndicator();
        alert('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ª–∞–π–∫–∞');
    });
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –∑–∞–≥—Ä—É–∑–∫–∏
function showLoadingIndicator() {
    // –°–æ–∑–¥–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
    const loader = document.createElement('div');
    loader.id = 'global-loader';
    loader.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        color: #D4AF37;
        font-size: 1.5em;
        font-weight: bold;
    `;
    loader.innerHTML = `
        <div style="text-align: center;">
            <div style="font-size: 2em; margin-bottom: 10px;">‚è≥</div>
            <div>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞...</div>
        </div>
    `;
    document.body.appendChild(loader);
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –∑–∞–≥—Ä—É–∑–∫–∏
function hideLoadingIndicator() {
    const loader = document.getElementById('global-loader');
    if (loader) {
        loader.remove();
    }
}

// –¢–∞–∫–∂–µ –æ–±–Ω–æ–≤–∏–º —Ñ—É–Ω–∫—Ü–∏—é toggleArticleLike –≤ article_detail.html –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
// –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ liked-articles
function toggleArticleLike() {
    const likeButton = document.getElementById('articleLikeButton');
    const likesCount = document.getElementById('articleLikesCount');

    const path = window.location.pathname;
    const match = path.match(/\/article\/([^\/]+)\//);
    const articleSlug = match ? match[1] : null;

    if (!articleSlug) {
        alert('–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç–∞—Ç—å—é');
        return;
    }

    const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]')?.value;

    if (!csrfToken) {
        alert('–û—à–∏–±–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
        return;
    }

    const originalHTML = likeButton.innerHTML;
    likeButton.innerHTML = '...';
    likeButton.disabled = true;

    const formData = new FormData();
    formData.append('csrfmiddlewaretoken', csrfToken);

    fetch(`/article/${articleSlug}/like/`, {
        method: 'POST',
        headers: {
            'X-CSRFToken': csrfToken,
        },
        body: formData,
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            if (data.liked) {
                likeButton.innerHTML = '‚ù§Ô∏è –ù—Ä–∞–≤–∏—Ç—Å—è';
                likeButton.classList.add('liked');
            } else {
                likeButton.innerHTML = 'ü§ç –ù—Ä–∞–≤–∏—Ç—Å—è';
                likeButton.classList.remove('liked');
            }
            likesCount.textContent = data.likes_count;

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ "–ü–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è"
            const isOnLikedPage = window.location.pathname.includes('/liked-articles/');

            // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–±—Ä–∞–ª –ª–∞–π–∫ –∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ "–ü–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è"
            if (isOnLikedPage && data.was_liked && !data.liked) {
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
                setTimeout(() => {
                    window.location.reload();
                }, 1000);
            }
        }
    })
    .catch(error => {
        console.error('Error:', error);
        likeButton.innerHTML = originalHTML;
    })
    .finally(() => {
        likeButton.disabled = false;
    });
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
document.addEventListener('DOMContentLoaded', function() {
    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ª–∞–π–∫–æ–≤
    const likeBtns = document.querySelectorAll('.like-btn');
    likeBtns.forEach(btn => {
        const articleSlug = btn.getAttribute('data-article-slug');
        const articleTitle = btn.closest('.article-card').querySelector('.article-title a').textContent;
        btn.setAttribute('data-article-title', articleTitle);
        btn.onclick = () => confirmUnlike(articleSlug, articleTitle);
    });

    // –¢–∞–∫–∂–µ –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ "–£–±—Ä–∞—Ç—å –ª–∞–π–∫"
    const unlikeBtns = document.querySelectorAll('.btn-unlike');
    unlikeBtns.forEach(btn => {
        const articleSlug = btn.getAttribute('data-article-slug') ||
                           btn.closest('.article-card').querySelector('.like-btn').getAttribute('data-article-slug');
        const articleTitle = btn.getAttribute('data-article-title') ||
                            btn.closest('.article-card').querySelector('.article-title a').textContent;
        btn.setAttribute('data-article-slug', articleSlug);
        btn.setAttribute('data-article-title', articleTitle);
        btn.onclick = () => confirmUnlike(articleSlug, articleTitle);
    });
});

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—á–µ—Ç—á–∏–∫–∞ —Å—Ç–∞—Ç–µ–π
function updateArticlesCount() {
    const articlesGrid = document.querySelector('.articles-grid');
    const articlesCount = articlesGrid ? articlesGrid.children.length : 0;
    const statNumber = document.querySelector('.stat-number');

    if (statNumber && articlesCount === 0) {
        // –ï—Å–ª–∏ —Å—Ç–∞—Ç–µ–π –Ω–µ –æ—Å—Ç–∞–ª–æ—Å—å, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        showEmptyState();
    } else if (statNumber) {
        statNumber.textContent = articlesCount;
    }
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –ø—É—Å—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
function showEmptyState() {
    const container = document.querySelector('.liked-articles-container');
    const emptyStateHTML = `
        <div class="empty-state">
            <div class="empty-icon">‚ù§Ô∏è</div>
            <h3>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø–æ–Ω—Ä–∞–≤–∏–≤—à–∏—Ö—Å—è —Å—Ç–∞—Ç–µ–π</h3>
            <p>–ö–æ–≥–¥–∞ –≤—ã –±—É–¥–µ—Ç–µ —Å—Ç–∞–≤–∏—Ç—å –ª–∞–π–∫–∏ —Å—Ç–∞—Ç—å—è–º, –æ–Ω–∏ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å.</p>
            <div class="empty-actions">
                <a href="{% url 'wiki:home' %}" class="btn btn-primary">üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
                <a href="{% url 'wiki:search' %}" class="btn btn-outline">üîç –ù–∞–π—Ç–∏ —Å—Ç–∞—Ç—å–∏</a>
            </div>
        </div>
    `;

    container.innerHTML = emptyStateHTML;
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
function showToast(message, type = 'info') {
    // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    const toast = document.createElement('div');
    toast.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 15px 20px;
        border-radius: 8px;
        color: white;
        font-weight: bold;
        z-index: 10001;
        transition: all 0.3s;
        opacity: 0;
        transform: translateX(100%);
    `;

    if (type === 'success') {
        toast.style.background = '#28a745';
    } else if (type === 'error') {
        toast.style.background = '#dc3545';
    } else {
        toast.style.background = '#17a2b8';
    }

    toast.textContent = message;
    document.body.appendChild(toast);

    // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
    setTimeout(() => {
        toast.style.opacity = '1';
        toast.style.transform = 'translateX(0)';
    }, 100);

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ
    setTimeout(() => {
        toast.style.opacity = '0';
        toast.style.transform = 'translateX(100%)';
        setTimeout(() => {
            document.body.removeChild(toast);
        }, 300);
    }, 3000);
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
document.addEventListener('DOMContentLoaded', function() {
    // –î–æ–±–∞–≤–ª—è–µ–º data-–∞—Ç—Ä–∏–±—É—Ç—ã –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ª–∞–π–∫–æ–≤
    const likeBtns = document.querySelectorAll('.like-btn');
    likeBtns.forEach(btn => {
        const articleSlug = btn.getAttribute('data-article-slug');
        const articleTitle = btn.closest('.article-card').querySelector('.article-title a').textContent;
        btn.setAttribute('data-article-title', articleTitle);
        btn.onclick = () => confirmUnlike(articleSlug, articleTitle);
    });
});
</script>
{% endblock %}